import{a as l,g as u,n as g,G as h,b as m,H as p}from"./header-wf8HbVZh.js";import{c as w}from"./justValidate-ywqcVI2V.js";import{g as b,d as f,c as R,a as v,s as E}from"./index.esm2017-CVpEnNBY.js";class D{app;auth;constructor(){this.app=l,this.auth=u()}registrationWithEmail(){const s=document.querySelector("#registrationMail"),t=s.value,e=document.querySelector("#registrationPassword"),o=e.value,a=document.querySelector("#registrationRepeatPassword");o===a.value&&g(this.auth,t,o).then(r=>{const i=r.user,c={email:i.email||"",name:"",photo:"",orders:[]};this.addUserToFirebase(i.uid,c).then(()=>{s.value="",e.value="",a.value="",window.location.href="account.html",console.log("Registration with email successful:",i)}).catch(d=>{console.error("Error adding user to Firebase: ",d)})}).catch(r=>{const i=r.code,c=r.message;console.error("Registration with email failed:",i,c)})}registrationWithGoogle(){const s=new h;m(this.auth,s).then(t=>{const e=t.user,o={email:e.email||"",name:e.displayName||"",photo:e.photoURL||"",orders:[]};this.addUserToFirebase(e.uid,o).then(()=>{window.location.href="account.html",console.log("Registration with Google successful:",e)}).catch(a=>{console.error("Error adding user to Firebase: ",a)})}).catch(t=>{const e=t.code,o=t.message;console.error("Registration with Google failed:",e,o)})}async addUserToFirebase(s,t){const e=b(l),o=f(R(e,"users"),s);if((await v(o)).exists()){console.log("User document already exists. Skipping addition.");return}await E(o,t).then(()=>{console.log("Document written with UID as documentId:",s)}).catch(r=>{console.error("Error adding document: ",r)})}}document.addEventListener("DOMContentLoaded",()=>{w();const n=new D;document.querySelector(".registration__btn-registration").addEventListener("click",()=>{n.registrationWithEmail()}),document.querySelector(".registration__form-btn-google").addEventListener("click",()=>{n.registrationWithGoogle()}),new p});
