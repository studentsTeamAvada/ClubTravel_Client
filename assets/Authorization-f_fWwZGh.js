import{a as i,g as u,s as l,G as d,b as h,H as g}from"./header-Z2glgHCi.js";import{j as m}from"./justValidate-ywqcVI2V.js";import{g as p,d as w,c as z,a as b,s as f}from"./index.esm2017-VUyrWc--.js";class A{app;auth;constructor(){this.app=i,this.auth=u()}authorizationWithEmail(){const e=document.querySelector("#authorizationMail"),t=e.value,o=document.querySelector("#authorizationPassword"),a=o.value;l(this.auth,t,a).then(s=>{const n=s.user;window.location.href="account.html",e.value="",o.value="",console.log("User signed in:",n)}).catch(s=>{const n=s.code,c=s.message;alert("Почта или пароль введены неверно"),console.error("Login failed:",n,c)})}authorizationWithGoogle(){const e=new d;h(this.auth,e).then(t=>{const o=t.user,a={email:o.email||"",name:o.displayName||"",photo:o.photoURL||"",orders:[]};this.addUserToFirebase(o.uid,a).then(()=>{window.location.href="account.html",console.log("Authorization with Google successful. UID:",o.uid)}).catch(s=>{console.error("Error adding user to Firebase: ",s)})}).catch(t=>{const o=t.code,a=t.message;alert("Не удалось войти с помощью Google"),console.error("Login failed:",o,a)})}async addUserToFirebase(e,t){const o=p(i),a=w(z(o,"users"),e);if((await b(a)).exists()){console.log("User document already exists. Skipping addition.");return}await f(a,t).then(()=>{console.log("Document written with UID as documentId:",e)}).catch(n=>{console.error("Error adding document: ",n)})}}document.addEventListener("DOMContentLoaded",()=>{m();const r=new A;document.querySelector(".authorization__btn-registration").addEventListener("click",()=>{r.authorizationWithEmail()}),document.querySelector(".authorization__form-btn-google").addEventListener("click",()=>{r.authorizationWithGoogle()}),new g});
