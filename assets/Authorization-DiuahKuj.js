import{a as i,g as u,s as l,G as h,b as d,H as g}from"./header-Jv2ZkStG.js";import{j as m}from"./justValidate-ywqcVI2V.js";import{g as p,d as z,c as w,s as b}from"./index.esm2017-wBt5Meyf.js";class f{app;auth;constructor(){this.app=i,this.auth=u()}authorizationWithEmail(){const e=document.querySelector("#authorizationMail"),t=e.value,o=document.querySelector("#authorizationPassword"),n=o.value;l(this.auth,t,n).then(a=>{const s=a.user;window.location.href="account.html",e.value="",o.value="",console.log("User signed in:",s)}).catch(a=>{const s=a.code,c=a.message;alert("Почта или пароль введены неверно"),console.error("Login failed:",s,c)})}authorizationWithGoogle(){const e=new h;d(this.auth,e).then(t=>{const o=t.user,n={email:o.email||"",name:o.displayName||"",photo:o.photoURL||"",orders:[]};this.addUserToFirebase(o.uid,n).then(()=>{window.location.href="account.html",console.log("Authorization with Google successful. UID:",o.uid)}).catch(a=>{console.error("Error adding user to Firebase: ",a)})}).catch(t=>{const o=t.code,n=t.message;alert("Не удалось войти с помощью Google"),console.error("Login failed:",o,n)})}async addUserToFirebase(e,t){const o=p(i),n=z(w(o,"users"),e);await b(n,t).then(()=>{console.log("Document written with UID as documentId:",e)}).catch(a=>{console.error("Error adding document: ",a)})}}document.addEventListener("DOMContentLoaded",()=>{m();const r=new f;document.querySelector(".authorization__btn-registration").addEventListener("click",()=>{r.authorizationWithEmail()}),document.querySelector(".authorization__form-btn-google").addEventListener("click",()=>{r.authorizationWithGoogle()}),new g});
