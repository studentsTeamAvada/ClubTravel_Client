import{a as l,g,p as u,G as m,b as p,H as w}from"./header-u1vxfMaN.js";import{c as f}from"./justValidate-ywqcVI2V.js";import{g as W,d as b,c as E,a as v,s as D}from"./index.esm2017-WC45BDwc.js";import{B as d}from"./buttonEventHandler-4aVT9HNW.js";class G{app;auth;constructor(){this.app=l,this.auth=g(),this.registrationWithEmail=this.registrationWithEmail.bind(this),this.registrationWithGoogle=this.registrationWithGoogle.bind(this)}registrationWithEmail(){const s=document.querySelector("#registrationMail"),o=s.value,e=document.querySelector("#registrationPassword"),t=e.value,i=document.querySelector("#registrationRepeatPassword");t===i.value&&u(this.auth,o,t).then(r=>{const a=r.user,c={email:a.email||"",name:"",photo:"",orders:[]};this.addUserToFirebase(a.uid,c).then(()=>{s.value="",e.value="",i.value="",window.location.href="account.html",console.log("Registration with email successful:",a)}).catch(h=>{console.error("Error adding user to Firebase: ",h)})}).catch(r=>{const a=r.code,c=r.message;console.error("Registration with email failed:",a,c)})}registrationWithGoogle(){const s=new m;p(this.auth,s).then(o=>{const e=o.user,t={email:e.email||"",name:e.displayName||"",photo:e.photoURL||"",orders:[]};this.addUserToFirebase(e.uid,t).then(()=>{window.location.href="account.html",console.log("Registration with Google successful:",e)}).catch(i=>{console.error("Error adding user to Firebase: ",i)})}).catch(o=>{const e=o.code,t=o.message;console.error("Registration with Google failed:",e,t)})}async addUserToFirebase(s,o){const e=W(l),t=b(E(e,"users"),s);if((await v(t)).exists()){console.log("User document already exists. Skipping addition.");return}await D(t,o).then(()=>{console.log("Document written with UID as documentId:",s)}).catch(r=>{console.error("Error adding document: ",r)})}}document.addEventListener("DOMContentLoaded",()=>{f();const n=new G;new d(".registration__btn-registration",n,"registrationWithEmail"),new d(".registration__form-btn-google",n,"registrationWithGoogle"),new w});
